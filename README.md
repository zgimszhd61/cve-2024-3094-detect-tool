# CVE-2024-3094（XZ后门）检测器

## 概览

该工具检查本地机器是否同时满足以下两个条件：易受CVE-2024-3094（SSH负载能够运行）的攻击，以及当前受CVE-2024-3094（已安装恶意版本的XZ）的影响。

只有**两个条件都满足**时，机器才可能受CVE-2024-3094的影响。

### 恶意XZ/LZMA检查

该工具检查机器上当前是否安装了恶意版本的`xz`或`liblzma`。该检查是静态进行的，不需要运行`xz`二进制文件。

### 易受攻击的SSH检查

该工具检查当前安装的SSH服务器（`sshd`）是否链接到`liblzma`。不链接到lzma的SSH服务器不会受CVE-2024-3094的影响，因为后门永远不会激活。

## 要求

使用`strings`工具（`binutils`的一部分）

```
sudo apt install binutils
```

## 使用方法

```bash
./cve-2024-3094-detector.sh
```

该工具将检查上一节中提到的前提条件。