# CVE-2024-3094 (XZ Backdoor) Detector

## Overview

The tool checks whether the local machine is both vulnerable to CVE-2024-3094 (SSH payload is able to run) and currently affected by CVE-2024-3094 (malicious version of XZ is currently installed).

The machine is potentially affected by CVE-2024-3094 only if **both** conditions are true.



### Malicious XZ/LZMA check

The tool checks whether a malicious version of `xz` or `liblzma` is currently installed on the machine. The check is performed statically, without running the `xz` binary.



### Vulnerable SSH check

The tool checks whether the currently installed SSH server (`sshd`) links to `liblzma`. SSH servers that do not link to lzma are not affected by CVE-2024-3094 as the backdoor will never activate.




## Requirements

Uses the `strings` utility (part of `binutils`)

```
sudo apt install binutils
```



## Usage

```bash
./cve-2024-3094-detector.sh
```

The tool will check for the preconditions mentioned in the last section. 